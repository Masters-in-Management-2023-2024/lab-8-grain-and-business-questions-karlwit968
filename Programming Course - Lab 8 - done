{"cells":[{"cell_type":"markdown","metadata":{"id":"1CT6exP197zw"},"source":["# Diamond Company Analytics Challenge\n","\n","**Time:** 35 minutes\n","\n","**Scenario:** You are the new data analyst at a prestigious diamond company. The CEO has called an urgent meeting and needs answers to critical business questions about the inventory.\n","\n","**Your Mission:** Analyze the diamond inventory data and provide insights to guide strategic decisions."]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UizS_bvW97zx","executionInfo":{"status":"ok","timestamp":1755098000131,"user_tz":240,"elapsed":34,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"1e461f7b-493d-4900-cc6c-4ffe2f392704"},"outputs":[{"output_type":"stream","name":"stdout","text":["Loading diamonds dataset...\n","Dataset loaded successfully!\n"]}],"source":["import polars as pl\n","\n","# Load the diamonds dataset\n","print(\"Loading diamonds dataset...\")\n","df = pl.read_csv('https://raw.githubusercontent.com/pycaret/pycaret/master/datasets/diamond.csv')\n","print(\"Dataset loaded successfully!\")"]},{"cell_type":"markdown","metadata":{"id":"aDFfoaEk97zy"},"source":["## Section 1: Initial Inventory Assessment (5 minutes)\n","\n","The CEO walks in: \"Before we dive into specifics, I need to understand what we're working with. Give me the basics about our inventory database.\""]},{"cell_type":"markdown","metadata":{"id":"FUpHr8Aw97zy"},"source":["### Question 1: \"How extensive is our inventory database?\"\n","\n","The CEO needs to know the scale of data you're analyzing."]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EQl-hfl397zz","executionInfo":{"status":"ok","timestamp":1755098243953,"user_tz":240,"elapsed":96,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"22fb5d95-4875-4b62-8202-f86b311e53b9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Total records: 6,000\n","Columns: 8\n","Unique items: 5,917\n"]}],"source":["# Your code here:\n","df = pl.read_csv('https://raw.githubusercontent.com/pycaret/pycaret/master/datasets/diamond.csv')\n","\n","print(f\"Total records: {df.height:,}\")\n","print(f\"Columns: {df.width}\")\n","print(f\"Unique items: {df.unique().height:,}\")\n"]},{"cell_type":"markdown","metadata":{"id":"n5DKbYAI97zz"},"source":["### Question 2: \"What information do we track about each diamond?\"\n","\n","List all the characteristics we record."]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dAQYTuTa97zz","executionInfo":{"status":"ok","timestamp":1755098359436,"user_tz":240,"elapsed":43,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"f82dc492-bb6c-4734-c9f2-12ef3a76b588"},"outputs":[{"output_type":"stream","name":"stdout","text":["Tracked characteristics:\n","['Carat Weight', 'Cut', 'Color', 'Clarity', 'Polish', 'Symmetry', 'Report', 'Price']\n"]}],"source":["# Your code here:\n","print(\"Tracked characteristics:\")\n","print(df.columns)\n"]},{"cell_type":"markdown","metadata":{"id":"1lPZJ0hK97zz"},"source":["### Question 3: \"When I look at one line in this database, what am I looking at?\"\n","\n","Explain in business terms:"]},{"cell_type":"markdown","metadata":{"id":"HVW4pr4697zz"},"source":["**Your answer:** Each row represents: Characterisitcs and crucial information for a specific diamond"]},{"cell_type":"markdown","metadata":{"id":"kew6ZM8R97zz"},"source":["## Section 2: Strategic Business Questions (20 minutes)\n","\n","The CEO continues: \"Now let's get to the important questions. Our board meeting is tomorrow and I need concrete numbers.\""]},{"cell_type":"markdown","metadata":{"id":"cnEsvCg897zz"},"source":["### Question 4: \"We're considering expanding our storage facilities. How many total carats do we have in inventory? I need to know if our vaults can handle the weight.\"\n","\n","Think about what measurement would help answer this."]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D4wXLbwj97z0","executionInfo":{"status":"ok","timestamp":1755098747280,"user_tz":240,"elapsed":5,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"ff313a1d-3c85-4f98-f6ab-d0c9b9761a65"},"outputs":[{"output_type":"stream","name":"stdout","text":["Total carat weight in inventory: 8,007.12\n"]}],"source":["# Your code here:\n","total_carats = df.select(pl.col(\"Carat Weight\").sum()).item()\n","print(f\"Total carat weight in inventory: {total_carats:,.2f}\")\n"]},{"cell_type":"markdown","metadata":{"id":"Le6CR7bo97z0"},"source":["### Question 5: \"Our new marketing campaign claims we have 'the widest variety of cuts in the industry.' Can you verify this?\"\n","\n","The CEO wants to know about variety, not quantity."]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cpOMwY9e97z0","executionInfo":{"status":"ok","timestamp":1755098804972,"user_tz":240,"elapsed":19,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"2dc1e61d-2ee9-482a-c544-76b8dc534e8c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Number of unique cuts: 5\n","shape: (5,)\n","Series: 'Cut' [str]\n","[\n","\t\"Fair\"\n","\t\"Ideal\"\n","\t\"Good\"\n","\t\"Very Good\"\n","\t\"Signature-Ideal\"\n","]\n"]}],"source":["# Your code here:\n","variety_cuts = df[\"Cut\"].n_unique()\n","print(f\"Number of unique cuts: {variety_cuts}\")\n","print(df[\"Cut\"].unique())"]},{"cell_type":"markdown","metadata":{"id":"RTYhHb3X97z0"},"source":["### Question 6: \"I'm meeting with our insurance company. They need to know our price exposure - what's our most and least valuable diamond?\""]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_kRAZluP97z0","executionInfo":{"status":"ok","timestamp":1755098905379,"user_tz":240,"elapsed":7,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"878846b4-400d-461d-f052-c4a16f33691a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Most valuable diamond:\n","shape: (1, 8)\n","┌──────────────┬───────┬───────┬─────────┬────────┬──────────┬────────┬────────┐\n","│ Carat Weight ┆ Cut   ┆ Color ┆ Clarity ┆ Polish ┆ Symmetry ┆ Report ┆ Price  │\n","│ ---          ┆ ---   ┆ ---   ┆ ---     ┆ ---    ┆ ---      ┆ ---    ┆ ---    │\n","│ f64          ┆ str   ┆ str   ┆ str     ┆ str    ┆ str      ┆ str    ┆ i64    │\n","╞══════════════╪═══════╪═══════╪═════════╪════════╪══════════╪════════╪════════╡\n","│ 2.79         ┆ Ideal ┆ D     ┆ IF      ┆ EX     ┆ EX       ┆ GIA    ┆ 101561 │\n","└──────────────┴───────┴───────┴─────────┴────────┴──────────┴────────┴────────┘\n","Least valuable diamond:\n","shape: (1, 8)\n","┌──────────────┬──────┬───────┬─────────┬────────┬──────────┬────────┬───────┐\n","│ Carat Weight ┆ Cut  ┆ Color ┆ Clarity ┆ Polish ┆ Symmetry ┆ Report ┆ Price │\n","│ ---          ┆ ---  ┆ ---   ┆ ---     ┆ ---    ┆ ---      ┆ ---    ┆ ---   │\n","│ f64          ┆ str  ┆ str   ┆ str     ┆ str    ┆ str      ┆ str    ┆ i64   │\n","╞══════════════╪══════╪═══════╪═════════╪════════╪══════════╪════════╪═══════╡\n","│ 0.77         ┆ Good ┆ I     ┆ VS1     ┆ VG     ┆ G        ┆ AGSL   ┆ 2184  │\n","└──────────────┴──────┴───────┴─────────┴────────┴──────────┴────────┴───────┘\n"]}],"source":["# Your code here:\n","most_valuable = df.filter(pl.col(\"Price\") == df[\"Price\"].max())\n","least_valuable = df.filter(pl.col(\"Price\") == df[\"Price\"].min())\n","\n","print(\"Most valuable diamond:\")\n","print(most_valuable)\n","\n","print(\"Least valuable diamond:\")\n","print(least_valuable)"]},{"cell_type":"markdown","metadata":{"id":"W8fK4SDn97z0"},"source":["### Question 7: \"Which color grades should we focus on in our premium line? I need typical prices across our color spectrum.\"\n","\n","The CEO wants to understand pricing patterns."]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"loea175j97z0","executionInfo":{"status":"ok","timestamp":1755099004389,"user_tz":240,"elapsed":35,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"ebfb7649-4e57-4b1c-ed9d-10c4982cfd06"},"outputs":[{"output_type":"stream","name":"stdout","text":["shape: (6, 2)\n","┌───────┬──────────────┐\n","│ Color ┆ Price        │\n","│ ---   ┆ ---          │\n","│ str   ┆ f64          │\n","╞═══════╪══════════════╡\n","│ D     ┆ 15255.783661 │\n","│ F     ┆ 12712.241856 │\n","│ G     ┆ 12520.050633 │\n","│ E     ┆ 11539.190231 │\n","│ H     ┆ 10487.347544 │\n","│ I     ┆ 8989.636364  │\n","└───────┴──────────────┘\n"]}],"source":["# Your code here:\n","avg_price_by_color = df.group_by(\"Color\").agg(pl.col(\"Price\").mean()).sort(\"Price\", descending=True)\n","print(avg_price_by_color)"]},{"cell_type":"markdown","metadata":{"id":"aC7Xryhr97z0"},"source":["**Reflection:** After analyzing by color, how has your view of the data changed? What does each row in your result represent now?"]},{"cell_type":"markdown","metadata":{"id":"Vs4a-6gP97z0"},"source":["**Your answer:** New grain = Each row shows the average price per diamond colour."]},{"cell_type":"markdown","metadata":{"id":"SfWrLWvZ97z0"},"source":["## Section 3: Advanced Strategic Analysis (10 minutes)\n","\n","The CEO leans forward: \"These next questions will shape our strategy for next year.\""]},{"cell_type":"markdown","metadata":{"id":"mI9eoPzM97z0"},"source":["### Question 8: \"We're thinking of specializing in certain clarity grades. For our investor deck, I need a complete breakdown showing: how many diamonds we have in each clarity grade, their typical price, and the total carats we're holding for each grade.\""]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_Q8QJaeP97z1","executionInfo":{"status":"ok","timestamp":1755099075881,"user_tz":240,"elapsed":11,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"7295fcfc-508f-4ebf-a904-8a59b3f7544c"},"outputs":[{"output_type":"stream","name":"stdout","text":["shape: (7, 4)\n","┌─────────┬───────┬──────────────┬──────────────┐\n","│ Clarity ┆ Count ┆ avg_price    ┆ total_carats │\n","│ ---     ┆ ---   ┆ ---          ┆ ---          │\n","│ str     ┆ u32   ┆ f64          ┆ f64          │\n","╞═════════╪═══════╪══════════════╪══════════════╡\n","│ FL      ┆ 4     ┆ 63776.0      ┆ 7.87         │\n","│ IF      ┆ 219   ┆ 22105.844749 ┆ 316.0        │\n","│ VVS1    ┆ 285   ┆ 16845.680702 ┆ 389.43       │\n","│ VVS2    ┆ 666   ┆ 14142.177177 ┆ 876.58       │\n","│ VS1     ┆ 1192  ┆ 13694.113255 ┆ 1682.74      │\n","│ VS2     ┆ 1575  ┆ 11809.053333 ┆ 2170.81      │\n","│ SI1     ┆ 2059  ┆ 8018.864012  ┆ 2563.69      │\n","└─────────┴───────┴──────────────┴──────────────┘\n"]}],"source":["# Your code here:\n","clarity_breakdown = (\n","    df.group_by(\"Clarity\")\n","      .agg([\n","          pl.len().alias(\"Count\"),\n","          pl.col(\"Price\").mean().alias(\"avg_price\"),\n","          pl.col(\"Carat Weight\").sum().alias(\"total_carats\")\n","      ])\n","      .sort(\"avg_price\", descending=True)\n",")\n","\n","print(clarity_breakdown)"]},{"cell_type":"markdown","metadata":{"id":"mdG7I2ZD97z1"},"source":["### Question 9: \"My luxury competitor claims they have the best prices for every cut-color combination. Show me our pricing structure across these combinations - I want to see where we're competitive.\""]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8dQQW8lP97z1","executionInfo":{"status":"ok","timestamp":1755099161427,"user_tz":240,"elapsed":38,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"d1d1d824-4241-44b3-f5d0-4bfa4afbde90"},"outputs":[{"output_type":"stream","name":"stdout","text":["shape: (30, 3)\n","┌───────────┬───────┬──────────────┐\n","│ Cut       ┆ Color ┆ avg_price    │\n","│ ---       ┆ ---   ┆ ---          │\n","│ str       ┆ str   ┆ f64          │\n","╞═══════════╪═══════╪══════════════╡\n","│ Fair      ┆ D     ┆ 6058.25      │\n","│ Fair      ┆ E     ┆ 5370.625     │\n","│ Fair      ┆ F     ┆ 6063.625     │\n","│ Fair      ┆ G     ┆ 7345.52381   │\n","│ Fair      ┆ H     ┆ 5908.5       │\n","│ …         ┆ …     ┆ …            │\n","│ Very Good ┆ E     ┆ 12101.910217 │\n","│ Very Good ┆ F     ┆ 12413.905495 │\n","│ Very Good ┆ G     ┆ 12354.013841 │\n","│ Very Good ┆ H     ┆ 10056.106132 │\n","│ Very Good ┆ I     ┆ 8930.031332  │\n","└───────────┴───────┴──────────────┘\n"]}],"source":["# Your code here:\n","pricing_structure = (\n","    df.group_by([\"Cut\", \"Color\"])\n","      .agg(pl.col(\"Price\").mean().alias(\"avg_price\"))\n","      .sort([\"Cut\", \"Color\"])\n",")\n","\n","print(pricing_structure)"]},{"cell_type":"markdown","metadata":{"id":"iFffKnly97z1"},"source":["**Reflection:** How specific is your analysis now? What level of detail does each row represent?"]},{"cell_type":"markdown","metadata":{"id":"4CLV_uCS97z1"},"source":["**Your answer:** New grain = Each row now represents the average price for a specific cut–color combination of diamonds in the dataset."]},{"cell_type":"markdown","metadata":{"id":"dzfBJo_P97z1"},"source":["### Question 10: URGENT - \"Our biggest client is interested in purchasing entire inventory segments. They asked: 'Which color-cut combinations represent your highest total inventory value?' Show me the top 5 most valuable inventory segments by total worth, and include how many diamonds are in each segment.\"\n","\n","This is critical for tomorrow's negotiation."]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"glMDpFHX97z1","executionInfo":{"status":"ok","timestamp":1755099338948,"user_tz":240,"elapsed":43,"user":{"displayName":"Karl Witte","userId":"12683021148178478893"}},"outputId":"0503e7ea-742a-478b-ce9d-7e8127caac05"},"outputs":[{"output_type":"stream","name":"stdout","text":["shape: (5, 4)\n","┌───────┬───────────┬───────┬─────────────┐\n","│ Color ┆ Cut       ┆ Count ┆ Total_value │\n","│ ---   ┆ ---       ┆ ---   ┆ ---         │\n","│ str   ┆ str       ┆ u32   ┆ i64         │\n","╞═══════╪═══════════╪═══════╪═════════════╡\n","│ G     ┆ Ideal     ┆ 690   ┆ 9363514     │\n","│ G     ┆ Very Good ┆ 578   ┆ 7140620     │\n","│ F     ┆ Very Good ┆ 455   ┆ 5648327     │\n","│ F     ┆ Ideal     ┆ 363   ┆ 5346782     │\n","│ H     ┆ Ideal     ┆ 458   ┆ 5279687     │\n","└───────┴───────────┴───────┴─────────────┘\n"]}],"source":["# Your code here:\n","top_segments = (\n","    df.group_by([\"Color\", \"Cut\"])\n","      .agg([\n","          pl.len().alias(\"Count\"),\n","          (pl.col(\"Price\").sum()).alias(\"Total_value\")\n","      ])\n","      .sort(\"Total_value\", descending=True)\n","      .head(5)\n",")\n","\n","print(top_segments)"]},{"cell_type":"markdown","metadata":{"id":"-HlyjwnL97z1"},"source":["## Debrief\n","\n","Congratulations! You've just completed your first day as the diamond company's data analyst.\n","\n","Remember:\n","- CEOs speak in business language, not technical terms\n","- Always understand what each row represents before analyzing\n","- Business questions contain clues about which operations to use"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.12.0"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":0}